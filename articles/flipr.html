<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A tour of permutation inference • flipr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="A tour of permutation inference">
<meta property="og:description" content="flipr">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flipr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/flipr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/alternative.html">The alternative hypothesis in permutation testing</a>
    </li>
    <li>
      <a href="../articles/exactness.html">On the exactness of permutation tests</a>
    </li>
    <li>
      <a href="../articles/plausibility.html">Computing plausibility functions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/astamm/flipr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="flipr_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>A tour of permutation inference</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/astamm/flipr/blob/master/vignettes/flipr.Rmd"><code>vignettes/flipr.Rmd</code></a></small>
      <div class="hidden name"><code>flipr.Rmd</code></div>

    </div>

    
    
<p>The permutation framework is perfectly suited for making inference as it allows one to perform point estimation, confidence regions and hypothesis tests under mild assumptions about the collected data and no distributional assmuption. In this article, we briefly illustrate how each of these aspects can be treated from a permutation point of view using the <a href="https://astamm.github.io/flipr/"><strong>flipr</strong></a> package. This package has been written and is intended as a low-level implementation of the permutation framework in the context of statistical inference. The mathematical object behind the scene is the so-called plausibility function, sometimes called p-value function. This article explains what the plausbility function is and shows how it can be easily computed using the permutation framework with <a href="https://astamm.github.io/flipr/"><strong>flipr</strong></a>. We illustrate the shape of the plausibility function using both Gaussian and Gamma distributions.</p>
<div id="generation-of-the-toy-example" class="section level2">
<h2 class="hasAnchor">
<a href="#generation-of-the-toy-example" class="anchor"></a>Generation of the toy example</h2>
<p>Let us work on a very classic toy example. Suppose that we are interested in studying the difference in means of two populations. We will generate:</p>
<ul>
<li>A first sample of size <span class="math inline">\(n_1 = 10\)</span> observations from a distribution with mean <span class="math inline">\(1\)</span> and unit variance;</li>
<li>A second sample of size <span class="math inline">\(n_2 = 10\)</span> observations from a distribution with mean <span class="math inline">\(4\)</span> and unit variance.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n1</span> <span class="op">&lt;-</span> <span class="fl">10</span>
<span class="va">n2</span> <span class="op">&lt;-</span> <span class="fl">10</span>
<span class="va">mu1</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">mu2</span> <span class="op">&lt;-</span> <span class="fl">4</span>
<span class="va">sd1</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">sd2</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">B</span> <span class="op">&lt;-</span> <span class="fl">100000</span></code></pre></div>
<p>We will consider three different scenari:</p>
<dl>
<dt>Scenario A</dt>
<dd>
<p>Both populations follow Gaussian distributions.</p>
</dd>
</dl>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span>
<span class="va">a1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n1</span>, mean <span class="op">=</span> <span class="va">mu1</span>, sd <span class="op">=</span> <span class="va">sd1</span><span class="op">)</span>
<span class="va">a2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n2</span>, mean <span class="op">=</span> <span class="va">mu2</span>, sd <span class="op">=</span> <span class="va">sd2</span><span class="op">)</span></code></pre></div>
<dl>
<dt>Scenario B</dt>
<dd>
<p>Both populations follow Gamma distributions.</p>
</dd>
</dl>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span>
<span class="va">b1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html">rgamma</a></span><span class="op">(</span><span class="va">n1</span>, shape <span class="op">=</span> <span class="fl">1</span>, rate <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">b2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html">rgamma</a></span><span class="op">(</span><span class="va">n2</span>, shape <span class="op">=</span> <span class="fl">16</span>, rate <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></code></pre></div>
<dl>
<dt>Scenario C</dt>
<dd>
<p>The first population follows a Gaussian distribution while the second population follows a Gamma distribution.</p>
</dd>
</dl>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span>
<span class="va">c1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n1</span>, mean <span class="op">=</span> <span class="va">mu1</span>, sd <span class="op">=</span> <span class="va">sd1</span><span class="op">)</span>
<span class="va">c2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html">rgamma</a></span><span class="op">(</span><span class="va">n2</span>, shape <span class="op">=</span> <span class="fl">16</span>, rate <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></code></pre></div>
<p>For each scenario, the goal is to make inference on the difference between the means of the two distributions. In other words, the parameter of interest is <span class="math inline">\(\delta = \mu_2 - \mu_1\)</span>.</p>
</div>
<div id="the-plausibility-function" class="section level2">
<h2 class="hasAnchor">
<a href="#the-plausibility-function" class="anchor"></a>The plausibility function</h2>
<p>The plausibility function for the mean difference is a curve that represents the variation of the <span class="math inline">\(p\)</span>-value of a test in which the null hypothesis is <span class="math inline">\(\delta = \delta_0\)</span> as a function of <span class="math inline">\(\delta_0\)</span> <span class="citation">(Martin 2017; Fraser 2019; Infanger and Schmidt-Trucksäss 2019)</span>.</p>
<p>With <a href="https://astamm.github.io/flipr/"><strong>flipr</strong></a>, it is easy to trace such a plausibility function. Three ingredients are required alongside the data to instantiate such a function:</p>
<ul>
<li>a null specification function that tells <a href="https://astamm.github.io/flipr/"><strong>flipr</strong></a> how the second sample should be transformed in order to make it exchangeable with the first sample under the null hypothesis;</li>
<li>a list of test statistics to use for detecting differences between the distributions that generated the two observed samples;</li>
<li>a list of index assignments that tells <a href="https://astamm.github.io/flipr/"><strong>flipr</strong></a> which test statistics to use for each parameter under investigation.</li>
</ul>
<div id="null-specification" class="section level3">
<h3 class="hasAnchor">
<a href="#null-specification" class="anchor"></a>Null specification</h3>
<p>In the context of null hypothesis testing, we consider the null hypothesis <span class="math inline">\(H_0: \mu_y - \mu_x = \delta\)</span>. We can use a permutation scheme to approach the <span class="math inline">\(p\)</span>-value if the two samples are <em>exchangeable</em> under <span class="math inline">\(H_0\)</span>. This means that we need to transform for example the second sample to <em>make</em> it exchangeable with the first sample under <span class="math inline">\(H_0\)</span>. In this simple example, this can be achieved as follows. Let <span class="math inline">\(X_1, \dots, X_{n_x} \sim \mathcal{N}(\mu_x, 1)\)</span> and <span class="math inline">\(Y_1, \dots, Y_{n_y} \sim \mathcal{N}(\mu_y, 1)\)</span>. We can then transform the second sample as <span class="math inline">\(Y_i \longleftarrow Y_i - \delta\)</span>.</p>
<p>We can define a proper function to do this, termed the <em>null specification</em> function, which takes two input arguments:</p>
<ul>
<li>
<code>y</code> which is a list storing the data points in the second sample;</li>
<li>
<code>parameters</code> which is a numeric vector of values for the parameters under investigation (here only <span class="math inline">\(\delta\)</span> and thus <code>parameters</code> is of length <span class="math inline">\(1\)</span> with <code>parameters[1] = delta</code>).</li>
</ul>
<p>In our simple example, it boils down to:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">null_spec</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span>, <span class="va">parameters</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">y</span>, <span class="op">~</span> <span class="va">.x</span> <span class="op">-</span> <span class="va">parameters</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="test-statistics" class="section level3">
<h3 class="hasAnchor">
<a href="#test-statistics" class="anchor"></a>Test statistics</h3>
<p>Next, we need to decide which test statistic(s) we are going to use for performing the test. Here, we are only interested in one parameter, namely the mean difference <span class="math inline">\(\delta\)</span>. Since the two samples share the same variance, we can use for example the <span class="math inline">\(t\)</span>-statistic with a pooled estimate of the common variance.</p>
<p>This statistic can be easily computed using <code>stats::t.test(x, y, var.equal = TRUE)$statistic</code>. However, we want to extend its evaluation to any permuted version of the data. Test statistic functions compatible with <a href="https://astamm.github.io/flipr/"><strong>flipr</strong></a> should have at least two mandatory input arguments:</p>
<ul>
<li>
<code>data</code> which is either a concatenated list of size <span class="math inline">\(n_x + n_y\)</span> regrouping the data points of both samples or a distance matrix of size <span class="math inline">\((n_x + n_y) \times (n_x + n_y)\)</span> stored as an object of class <code>dist</code>.</li>
<li>
<code>indices1</code> which is an integer vector of size <span class="math inline">\(n_x\)</span> storing the indices of the data points belonging to the first sample in the current permuted version of the data.</li>
</ul>
<p>A <a href="https://astamm.github.io/flipr/"><strong>flipr</strong></a>-compatible version of the t-statistic is already implemented in <a href="https://astamm.github.io/flipr/"><strong>flipr</strong></a> and ready to use as <code>stat_student</code> or its alias <code>stat_t</code>. Here, we are only going to use the <span class="math inline">\(t\)</span>-statistic for this example, but we might be willing to use more than one statistic for a parameter or we might have several parameters under investigation, each one of them requiring a different test statistic. We therefore group all the test statistics that we need into a single list:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stat_functions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">stat_t</span><span class="op">)</span></code></pre></div>
</div>
<div id="statistic-assignments" class="section level3">
<h3 class="hasAnchor">
<a href="#statistic-assignments" class="anchor"></a>Statistic assignments</h3>
<p>Finally we need to define a named list that tells <a href="https://astamm.github.io/flipr/"><strong>flipr</strong></a> which test statistics among the ones declared in the <code>stat_functions</code> list should be used for each parameter under investigation. This is used to determine bounds on each parameter for the plausibility function. This list, often termed <code>stat_assignments</code>, should therefore have as many elements as there are parameters under investigation. Each element should be named after a parameter under investigation and should list the indices corresponding to the test statistics that should be used for that parameter in <code>stat_functions</code>. In our example, it boils down to:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stat_assignments</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>delta <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
</div>
<div id="instantiation-of-the-plausibility-function" class="section level3">
<h3 class="hasAnchor">
<a href="#instantiation-of-the-plausibility-function" class="anchor"></a>Instantiation of the plausibility function</h3>
<p>In <a href="https://astamm.github.io/flipr/"><strong>flipr</strong></a>, the plausibility function is implemented as an <a href="https://r6.r-lib.org/reference/R6Class.html">R6Class</a> object. Assume we observed two samples stored in lists <code>x</code> and <code>y</code>, we therefore instantiate a plausibility function for this data as follows:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pf</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/PlausibilityFunction.html">PlausibilityFunction</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>
  null_spec <span class="op">=</span> <span class="va">null_spec</span>,
  stat_functions <span class="op">=</span> <span class="va">stat_functions</span>,
  stat_assignments <span class="op">=</span> <span class="va">stat_assignments</span>,
  <span class="va">x</span>, <span class="va">y</span>
<span class="op">)</span></code></pre></div>
<p>Now, assume we want to test the following hypotheses:</p>
<p><span class="math display">\[ H_0: \delta = 0 \quad \mbox{v.s.} \quad H_1: \delta \ne 0. \]</span></p>
<p>We use the <code>$get_value()</code> method for this purpose, which essentially evaluates the permutation <span class="math inline">\(p\)</span>-value of a two-sided test by default:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pf</span><span class="op">$</span><span class="fu">get_value</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></code></pre></div>
<p>It is possible to evaluate one-sided p-values as well by changing the <code>$alternative</code> field through the <code>$set_alternative()</code> method, which accepts <code>two_tail</code>, <code>left_tail</code> and <code>right_tail</code> values.`</p>
<p>By default, the number of sampled permutations is <code>1000L</code>. It is accessible through the <code>$nperms</code> field and can be changed via the <code>$set_nperms()</code> method.</p>
</div>
</div>
<div id="application-to-the-toy-example" class="section level2">
<h2 class="hasAnchor">
<a href="#application-to-the-toy-example" class="anchor"></a>Application to the toy example</h2>
<div id="scenario-a" class="section level3">
<h3 class="hasAnchor">
<a href="#scenario-a" class="anchor"></a>Scenario A</h3>
<p>Let us instantiate the plausibility for the data simulated under scenario A:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pfa</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/PlausibilityFunction.html">PlausibilityFunction</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>
  null_spec <span class="op">=</span> <span class="va">null_spec</span>,
  stat_functions <span class="op">=</span> <span class="va">stat_functions</span>,
  stat_assignments <span class="op">=</span> <span class="va">stat_assignments</span>,
  <span class="va">a1</span>, <span class="va">a2</span>
<span class="op">)</span>
<span class="va">pfa</span><span class="op">$</span><span class="fu">set_nperms</span><span class="op">(</span><span class="va">B</span><span class="op">)</span></code></pre></div>
<p>We can compute a point estimate of the mean difference and store it inside the plausibility function class via the <code>$set_point_estimate()</code> method:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pfa</span><span class="op">$</span><span class="fu">set_point_estimate</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">a2</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">a1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The computed value can then be accessed via the <code>$point_estimate</code> field:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pfa</span><span class="op">$</span><span class="va">point_estimate</span>
<span class="co">#&gt;    delta </span>
<span class="co">#&gt; 3.264987</span></code></pre></div>
<p>or by displaying the list of parameters under investigation which is stored in the <code>$parameters</code> field.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pfa</span><span class="op">$</span><span class="va">parameters</span></code></pre></div>
<pre><code>#&gt; $delta
#&gt; Delta (quantitative)
#&gt; Range: [?, ?]
#&gt; Point estimate: 3.26</code></pre>
<p>In this list, one can see that parameters come with an unknown range by default. We can however compute their bounds by defining a maximum confidence level through the <code>$set_max_conf_level()</code> method of the <code>PlausibilityFunction</code> class. When a plausibility function is instantiated, the default value for the <code>$max_conf_level</code> field is <span class="math inline">\(0.99\)</span>. To set parameter bounds automatically, use the <code>$set_parameter_bounds()</code> method:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pfa</span><span class="op">$</span><span class="fu">set_parameter_bounds</span><span class="op">(</span>
  point_estimate <span class="op">=</span> <span class="va">pfa</span><span class="op">$</span><span class="va">point_estimate</span>, 
  conf_level <span class="op">=</span> <span class="va">pfa</span><span class="op">$</span><span class="va">max_conf_level</span>
<span class="op">)</span></code></pre></div>
<p>We can now inspect again the list of parameters under investigation to see the updated bounds:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pfa</span><span class="op">$</span><span class="va">parameters</span>
<span class="co">#&gt; $delta</span>
<span class="co">#&gt; Delta (quantitative)</span>
<span class="co">#&gt; Range: [2.02, 4.7]</span>
<span class="co">#&gt; Point estimate: 3.26</span></code></pre></div>
<p>Once bounds are known for each parameter, it becomes possible to generate a grid for later evaluating the plausibility function. This is done through the <code>$set_grid()</code> method as follows:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pfa</span><span class="op">$</span><span class="fu">set_grid</span><span class="op">(</span>
  parameters <span class="op">=</span> <span class="va">pfa</span><span class="op">$</span><span class="va">parameters</span>, 
  npoints <span class="op">=</span> <span class="fl">50L</span>
<span class="op">)</span></code></pre></div>
<p>We can then take a look at the newly created grid:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pfa</span><span class="op">$</span><span class="va">grid</span></code></pre></div>
<pre><code>#&gt; # A tibble: 51 × 1
#&gt;    delta
#&gt;    &lt;dbl&gt;
#&gt;  1  2.02
#&gt;  2  2.07
#&gt;  3  2.12
#&gt;  4  2.17
#&gt;  5  2.22
#&gt;  6  2.27
#&gt;  7  2.32
#&gt;  8  2.37
#&gt;  9  2.42
#&gt; 10  2.47
#&gt; # … with 41 more rows</code></pre>
<p>We can go a step further and evaluate the plaubility function on that grid using the <code>$evaluate_grid()</code> method as follows:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pfa</span><span class="op">$</span><span class="fu">evaluate_grid</span><span class="op">(</span>grid <span class="op">=</span> <span class="va">pfa</span><span class="op">$</span><span class="va">grid</span><span class="op">)</span></code></pre></div>
<p>Again, we can then take a look at the updated grid:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pfa</span><span class="op">$</span><span class="va">grid</span>
<span class="co">#&gt; # A tibble: 51 × 2</span>
<span class="co">#&gt;    delta pvalue</span>
<span class="co">#&gt;    &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt;  1  2.02 0.0102</span>
<span class="co">#&gt;  2  2.07 0.0137</span>
<span class="co">#&gt;  3  2.12 0.0185</span>
<span class="co">#&gt;  4  2.17 0.0240</span>
<span class="co">#&gt;  5  2.22 0.0317</span>
<span class="co">#&gt;  6  2.27 0.0405</span>
<span class="co">#&gt;  7  2.32 0.0520</span>
<span class="co">#&gt;  8  2.37 0.0659</span>
<span class="co">#&gt;  9  2.42 0.0834</span>
<span class="co">#&gt; 10  2.47 0.104 </span>
<span class="co">#&gt; # … with 41 more rows</span></code></pre></div>
<p>We can add to this grid the p-value computed from the t-test assuming normality of the data:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dfa</span> <span class="op">&lt;-</span> <span class="va">pfa</span><span class="op">$</span><span class="va">grid</span> |&gt; 
  <span class="fu">mutate</span><span class="op">(</span>
    pvalue_alt <span class="op">=</span> <span class="va">delta</span> <span class="op">%&gt;%</span>
      <span class="fu">map_dbl</span><span class="op">(</span><span class="op">~</span> <span class="op">{</span>
        <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span>
          x <span class="op">=</span> <span class="va">a2</span>, 
          y <span class="op">=</span> <span class="va">a1</span>, 
          alternative <span class="op">=</span> <span class="st">"two.sided"</span>, 
          mu <span class="op">=</span> <span class="va">.x</span>, 
          var.equal <span class="op">=</span> <span class="cn">TRUE</span>
        <span class="op">)</span><span class="op">$</span><span class="va">p.value</span>
      <span class="op">}</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span>
    <span class="va">delta</span>, 
    `Parametric Approach`  <span class="op">=</span> <span class="va">pvalue_alt</span>, 
    `Permutation Approach` <span class="op">=</span> <span class="va">pvalue</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">pivot_longer</span><span class="op">(</span><span class="op">-</span><span class="va">delta</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dfa</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">value</span> <span class="op">&gt;</span> <span class="fl">1e-3</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">delta</span>, <span class="va">value</span>, color <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_hline</span><span class="op">(</span>
    yintercept <span class="op">=</span> <span class="fl">0.05</span>, 
    color <span class="op">=</span> <span class="st">"black"</span>, 
    linetype <span class="op">=</span> <span class="st">"dashed"</span>
  <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">labs</span><span class="op">(</span>
    title <span class="op">=</span> <span class="st">"Scenario A: P-value function for the mean difference"</span>, 
    subtitle <span class="op">=</span> <span class="st">"Using Student's t-statistic and two-tailed p-values"</span>, 
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">delta</span><span class="op">)</span>, 
    y <span class="op">=</span> <span class="st">"p-value"</span>, 
    color <span class="op">=</span> <span class="st">"Type of test"</span>
  <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="flipr_files/figure-html/unnamed-chunk-23-1.png" width="97%"></p>
</div>
<div id="scenario-b" class="section level3">
<h3 class="hasAnchor">
<a href="#scenario-b" class="anchor"></a>Scenario B</h3>
<p>However, keep in mind that the parametric Student’s <span class="math inline">\(t\)</span>-test is only valid for Gaussian data or for large samples invoking the central limit theorem. When sample sizes are low and samples are not drawn from Gaussian distributions, only the permutation approach is valid. When both samples come from non-Gaussian data (here Gamma-distributed samples) and sample sizes are low (here <span class="math inline">\(10\)</span> for each sample), we get the following <span class="math inline">\(p\)</span>-value functions (cutting below <span class="math inline">\(0.001\)</span> since the usual range of useful <span class="math inline">\(p\)</span>-values is from <span class="math inline">\(0.01\)</span> and above):</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pfb</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/PlausibilityFunction.html">PlausibilityFunction</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>
  null_spec <span class="op">=</span> <span class="va">null_spec</span>,
  stat_functions <span class="op">=</span> <span class="va">stat_functions</span>,
  stat_assignments <span class="op">=</span> <span class="va">stat_assignments</span>,
  <span class="va">b1</span>, <span class="va">b2</span>
<span class="op">)</span>
<span class="va">pfb</span><span class="op">$</span><span class="fu">set_nperms</span><span class="op">(</span><span class="va">B</span><span class="op">)</span>
<span class="va">pfb</span><span class="op">$</span><span class="fu">set_point_estimate</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">b2</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">b1</span><span class="op">)</span><span class="op">)</span>
<span class="va">pfb</span><span class="op">$</span><span class="fu">set_parameter_bounds</span><span class="op">(</span>
  point_estimate <span class="op">=</span> <span class="va">pfb</span><span class="op">$</span><span class="va">point_estimate</span>, 
  conf_level <span class="op">=</span> <span class="va">pfb</span><span class="op">$</span><span class="va">max_conf_level</span>
<span class="op">)</span>
<span class="va">pfb</span><span class="op">$</span><span class="fu">set_grid</span><span class="op">(</span>
  parameters <span class="op">=</span> <span class="va">pfb</span><span class="op">$</span><span class="va">parameters</span>, 
  npoints <span class="op">=</span> <span class="fl">50L</span>
<span class="op">)</span>
<span class="va">pfb</span><span class="op">$</span><span class="fu">evaluate_grid</span><span class="op">(</span>grid <span class="op">=</span> <span class="va">pfb</span><span class="op">$</span><span class="va">grid</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dfb</span> <span class="op">&lt;-</span> <span class="va">pfb</span><span class="op">$</span><span class="va">grid</span> |&gt; 
  <span class="fu">mutate</span><span class="op">(</span>
    pvalue_alt <span class="op">=</span> <span class="va">delta</span> <span class="op">%&gt;%</span>
      <span class="fu">map_dbl</span><span class="op">(</span><span class="op">~</span> <span class="op">{</span>
        <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span>
          x <span class="op">=</span> <span class="va">b2</span>, 
          y <span class="op">=</span> <span class="va">b1</span>, 
          alternative <span class="op">=</span> <span class="st">"two.sided"</span>, 
          mu <span class="op">=</span> <span class="va">.x</span>, 
          var.equal <span class="op">=</span> <span class="cn">TRUE</span>
        <span class="op">)</span><span class="op">$</span><span class="va">p.value</span>
      <span class="op">}</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span>
    <span class="va">delta</span>, 
    `Parametric Approach`  <span class="op">=</span> <span class="va">pvalue_alt</span>, 
    `Permutation Approach` <span class="op">=</span> <span class="va">pvalue</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">pivot_longer</span><span class="op">(</span><span class="op">-</span><span class="va">delta</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dfb</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">value</span> <span class="op">&gt;</span> <span class="fl">1e-3</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">delta</span>, <span class="va">value</span>, color <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_hline</span><span class="op">(</span>
    yintercept <span class="op">=</span> <span class="fl">0.05</span>, 
    color <span class="op">=</span> <span class="st">"black"</span>, 
    linetype <span class="op">=</span> <span class="st">"dashed"</span>
  <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">labs</span><span class="op">(</span>
    title <span class="op">=</span> <span class="st">"Scenario B: P-value function for the mean difference"</span>, 
    subtitle <span class="op">=</span> <span class="st">"Using Student's t-statistic and two-tailed p-values"</span>, 
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">delta</span><span class="op">)</span>, 
    y <span class="op">=</span> <span class="st">"p-value"</span>, 
    color <span class="op">=</span> <span class="st">"Type of test"</span>
  <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="flipr_files/figure-html/unnamed-chunk-26-1.png" width="97%"></p>
<p>The parametric <span class="math inline">\(p\)</span>-value function is clearly shifted in the decreasing part on the right of the plot.</p>
</div>
<div id="scenario-c" class="section level3">
<h3 class="hasAnchor">
<a href="#scenario-c" class="anchor"></a>Scenario C</h3>
<p>When only one of the samples come from non-Gaussian data (here the second sample is Gamma-distributed and sample sizes are low (here <span class="math inline">\(10\)</span> for each sample), we get the following <span class="math inline">\(p\)</span>-value functions (cutting below <span class="math inline">\(0.001\)</span> since the usual range of useful <span class="math inline">\(p\)</span>-values is from <span class="math inline">\(0.01\)</span> and above):</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pfc</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/PlausibilityFunction.html">PlausibilityFunction</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>
  null_spec <span class="op">=</span> <span class="va">null_spec</span>,
  stat_functions <span class="op">=</span> <span class="va">stat_functions</span>,
  stat_assignments <span class="op">=</span> <span class="va">stat_assignments</span>,
  <span class="va">c1</span>, <span class="va">c2</span>
<span class="op">)</span>
<span class="va">pfc</span><span class="op">$</span><span class="fu">set_nperms</span><span class="op">(</span><span class="va">B</span><span class="op">)</span>
<span class="va">pfc</span><span class="op">$</span><span class="fu">set_point_estimate</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">c2</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">c1</span><span class="op">)</span><span class="op">)</span>
<span class="va">pfc</span><span class="op">$</span><span class="fu">set_parameter_bounds</span><span class="op">(</span>
  point_estimate <span class="op">=</span> <span class="va">pfc</span><span class="op">$</span><span class="va">point_estimate</span>, 
  conf_level <span class="op">=</span> <span class="va">pfc</span><span class="op">$</span><span class="va">max_conf_level</span>
<span class="op">)</span>
<span class="va">pfc</span><span class="op">$</span><span class="fu">set_grid</span><span class="op">(</span>
  parameters <span class="op">=</span> <span class="va">pfc</span><span class="op">$</span><span class="va">parameters</span>, 
  npoints <span class="op">=</span> <span class="fl">50L</span>
<span class="op">)</span>
<span class="va">pfc</span><span class="op">$</span><span class="fu">evaluate_grid</span><span class="op">(</span>grid <span class="op">=</span> <span class="va">pfc</span><span class="op">$</span><span class="va">grid</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dfc</span> <span class="op">&lt;-</span> <span class="va">pfc</span><span class="op">$</span><span class="va">grid</span> |&gt; 
  <span class="fu">mutate</span><span class="op">(</span>
    pvalue_alt <span class="op">=</span> <span class="va">delta</span> <span class="op">%&gt;%</span>
      <span class="fu">map_dbl</span><span class="op">(</span><span class="op">~</span> <span class="op">{</span>
        <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span>
          x <span class="op">=</span> <span class="va">c2</span>, 
          y <span class="op">=</span> <span class="va">c1</span>, 
          alternative <span class="op">=</span> <span class="st">"two.sided"</span>, 
          mu <span class="op">=</span> <span class="va">.x</span>, 
          var.equal <span class="op">=</span> <span class="cn">TRUE</span>
        <span class="op">)</span><span class="op">$</span><span class="va">p.value</span>
      <span class="op">}</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span>
    <span class="va">delta</span>, 
    `Parametric Approach`  <span class="op">=</span> <span class="va">pvalue_alt</span>, 
    `Permutation Approach` <span class="op">=</span> <span class="va">pvalue</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">pivot_longer</span><span class="op">(</span><span class="op">-</span><span class="va">delta</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dfc</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">value</span> <span class="op">&gt;</span> <span class="fl">1e-3</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">delta</span>, <span class="va">value</span>, color <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_hline</span><span class="op">(</span>
    yintercept <span class="op">=</span> <span class="fl">0.05</span>, 
    color <span class="op">=</span> <span class="st">"black"</span>, 
    linetype <span class="op">=</span> <span class="st">"dashed"</span>
  <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">labs</span><span class="op">(</span>
    title <span class="op">=</span> <span class="st">"Scenario C: P-value function for the mean difference"</span>, 
    subtitle <span class="op">=</span> <span class="st">"Using Student's t-statistic and two-tailed p-values"</span>, 
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">delta</span><span class="op">)</span>, 
    y <span class="op">=</span> <span class="st">"p-value"</span>, 
    color <span class="op">=</span> <span class="st">"Type of test"</span>
  <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="flipr_files/figure-html/unnamed-chunk-29-1.png" width="97%"></p>
<p>The situation seems less critical here when only one sample is non-Gaussian but this is only one simulation using a Gamma-distributed second sample. The bias could be more important for other distributions.</p>
<p>Another issue with the parametric approach is that it is very limited in the type of data that one can use. The parametric <span class="math inline">\(t\)</span>-test for instance is only meant for real-valued data. It will not be applicable to multivariate data or functional data or topological data or network-valued data or any other type of data that is not representable as real-valued data. This further motivates inference via permutation.</p>
<p>Getting access to the <span class="math inline">\(p\)</span>-value function is key to making inference as point estimation, confidence regions and hypothesis tests all come as a by-product as we will show in the next sections.</p>
</div>
</div>
<div id="inferential-tasks-via-the-plausibility-function" class="section level2">
<h2 class="hasAnchor">
<a href="#inferential-tasks-via-the-plausibility-function" class="anchor"></a>Inferential tasks via the plausibility function</h2>
<div id="point-estimation" class="section level3">
<h3 class="hasAnchor">
<a href="#point-estimation" class="anchor"></a>Point estimation</h3>
<p>One can obtain a point estimate of the parameter under investigation by searching which value of the parameter reaches the maximum of the <span class="math inline">\(p\)</span>-value function (which is <span class="math inline">\(1\)</span>). One can use the <code>$set_point_estimate()</code> method to do that:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pfa</span><span class="op">$</span><span class="fu">set_point_estimate</span><span class="op">(</span>overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>The computed point estimate is then stored in the <code>$point_estimate</code> field and can be retrieved as:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pfa</span><span class="op">$</span><span class="va">point_estimate</span>
<span class="co">#&gt;    delta </span>
<span class="co">#&gt; 3.264987</span></code></pre></div>
</div>
<div id="confidence-intervals" class="section level3">
<h3 class="hasAnchor">
<a href="#confidence-intervals" class="anchor"></a>Confidence intervals</h3>
<p>One can obtain a confidence interval for the parameter under investigation by searching for which values of the parameter the <span class="math inline">\(p\)</span>-value function remains above a pre-specified significance level <span class="math inline">\(\alpha\)</span>. This is achieved via the <code>$set_parameter_bounds()</code> method:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pfa</span><span class="op">$</span><span class="fu">set_parameter_bounds</span><span class="op">(</span>
  point_estimate <span class="op">=</span> <span class="va">pfa</span><span class="op">$</span><span class="va">point_estimate</span>, 
  conf_level <span class="op">=</span> <span class="fl">0.95</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pfa</span><span class="op">$</span><span class="va">parameters</span>
<span class="co">#&gt; $delta</span>
<span class="co">#&gt; Delta (quantitative)</span>
<span class="co">#&gt; Range: [2.02, 4.7]</span>
<span class="co">#&gt; Point estimate: 3.26</span></code></pre></div>
</div>
<div id="hypothesis-tests" class="section level3">
<h3 class="hasAnchor">
<a href="#hypothesis-tests" class="anchor"></a>Hypothesis tests</h3>
<p>Extracting the <span class="math inline">\(p\)</span>-value for a single hypothesis test in which the null hypothesis is <span class="math inline">\(H_0: \delta = \delta_0\)</span> is immediate from the <span class="math inline">\(p\)</span>-value function as it boils down to evaluating the <span class="math inline">\(p\)</span>-value function in <span class="math inline">\(\delta_0\)</span>. Hence we can for instance test <span class="math inline">\(H_0: \delta = 3\)</span> against the alternative <span class="math inline">\(H_1: \delta \ne 3\)</span> using the following piece of code:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pfa</span><span class="op">$</span><span class="fu">set_nperms</span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span>
<span class="va">pfa</span><span class="op">$</span><span class="fu">get_value</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.5714259</span></code></pre></div>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-fraser2019">
<p>Fraser, D. A. S. 2019. “The P-Value Function and Statistical Inference.” <em>The American Statistician</em> 73 (sup1): 135–47. <a href="https://doi.org/10.1080/00031305.2018.1556735">https://doi.org/10.1080/00031305.2018.1556735</a>.</p>
</div>
<div id="ref-infanger2019">
<p>Infanger, Denis, and Arno Schmidt-Trucksäss. 2019. “P Value Functions: An Underused Method to Present Research Results and to Promote Quantitative Reasoning.” <em>Statistics in Medicine</em> 38 (21): 4189–97. <a href="https://doi.org/10.1002/sim.8293">https://doi.org/10.1002/sim.8293</a>.</p>
</div>
<div id="ref-martin2017">
<p>Martin, Ryan. 2017. “A Statistical Inference Course Based on P-Values.” <em>The American Statistician</em> 71 (2): 128–36. <a href="https://doi.org/10.1080/00031305.2016.1208629">https://doi.org/10.1080/00031305.2016.1208629</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Alessia Pini, Aymeric Stamm, Simone Vantini.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
