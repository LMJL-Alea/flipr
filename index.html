<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Flexible Inference via Permutations in R • flipr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Flexible Inference via Permutations in R">
<meta property="og:description" content="A flexible permutation framework for making 
    inference such as point estimation, confidence 
    intervals or hypothesis testing, on any kind of data, 
    be it univariate, multivariate, or more complex such 
    as network-valued data, topological data, functional 
    data or density-valued data.">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">flipr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.3.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="articles/flipr.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/alternative.html">The alternative hypothesis in permutation testing</a>
    </li>
    <li>
      <a href="articles/exactness.html">On the exactness of permutation tests</a>
    </li>
    <li>
      <a href="articles/plausibility.html">Computing plausibility functions</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/LMJL-Alea/flipr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="overview-">Overview <a href="https://lmjl-alea.github.io/flipr/" class="external-link"><img src="reference/figures/logo.png" align="right" height="139"></a>
<a class="anchor" aria-label="anchor" href="#overview-"></a>
</h1></div>
<!-- badges: start -->

<p>The goal of the <a href="https://lmjl-alea.github.io/flipr/" class="external-link"><strong>flipr</strong></a> package is to provide a flexible framework for making inference via permutation. The idea is to promote the permutation framework as an incredibly well-suited tool for inference on complex data. You supply your data, as complex as it might be, in the form of lists in which each entry stores one data point in a representation that suits you and <a href="https://lmjl-alea.github.io/flipr/" class="external-link"><strong>flipr</strong></a> takes care of the permutation magic and provides you with either point estimates or confidence regions or <span class="math inline"><em>p</em></span>-value of hypothesis tests. Permutation tests are especially appealing because they are exact no matter how small or big your sample sizes are. You can also use the so-called <em>non-parametric combination</em> approach in this setting to combine several statistics to better target the alternative hypothesis you are testing against. Asymptotic consistency is also guaranteed under mild conditions on the statistic you use. The <a href="https://lmjl-alea.github.io/flipr/" class="external-link"><strong>flipr</strong></a> package provides a flexible permutation framework for making inference such as point estimation, confidence intervals or hypothesis testing, on any kind of data, be it univariate, multivariate, or more complex such as network-valued data, topological data, functional data or density-valued data.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the latest stable version of <a href="https://lmjl-alea.github.io/flipr/" class="external-link"><strong>flipr</strong></a> on CRAN with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"flipr"</span><span class="op">)</span></span></code></pre></div>
<p>Or you can install the development version from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"LMJL-Alea/flipr"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://LMJL-Alea.github.io/flipr/" class="external-link">flipr</a></span><span class="op">)</span></span></code></pre></div>
<p>We hereby use the very simple t-test for comparing the means of two univariate samples to show how easy it is to carry out a permutation test with <a href="https://lmjl-alea.github.io/flipr/" class="external-link"><strong>flipr</strong></a>.</p>
<div class="section level3">
<h3 id="data-generation">Data generation<a class="anchor" aria-label="anchor" href="#data-generation"></a>
</h3>
<p>Let us first generate two samples of size <span class="math inline">15</span> governed by Gaussian distributions with equal variance but different means:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">15</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, mean <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Given the data we simulated, the parameter of interest here is the difference between the means of the distributions, say <span class="math inline"><em>δ</em> = <em>μ</em><sub><em>y</em></sub> − <em>μ</em><sub><em>x</em></sub></span>.</p>
</div>
<div class="section level3">
<h3 id="make-the-two-samples-exchangeable-under-h_0">Make the two samples exchangeable under <span class="math inline"><em>H</em><sub>0</sub></span>
<a class="anchor" aria-label="anchor" href="#make-the-two-samples-exchangeable-under-h_0"></a>
</h3>
<p>In the context of null hypothesis testing, we consider the null hypothesis <span class="math inline"><em>H</em><sub>0</sub> : <em>μ</em><sub><em>y</em></sub> − <em>μ</em><sub><em>x</em></sub> = <em>δ</em></span>. We can use a permutation scheme to approach the <span class="math inline"><em>p</em></span>-value if the two samples are <em>exchangeable</em> under <span class="math inline"><em>H</em><sub>0</sub></span>. This means that we need to transform for example the second sample to <em>make</em> it exchangeable with the first sample under <span class="math inline"><em>H</em><sub>0</sub></span>. In this simple example, this can be achieved as follows. Let <span class="math inline"><em>X</em><sub>1</sub>, …, <em>X</em><sub><em>n</em><sub><em>x</em></sub></sub> ∼ 𝒩(<em>μ</em><sub><em>x</em></sub>,1)</span> and <span class="math inline"><em>Y</em><sub>1</sub>, …, <em>Y</em><sub><em>n</em><sub><em>y</em></sub></sub> ∼ 𝒩(<em>μ</em><sub><em>y</em></sub>,1)</span>. We can then transform the second sample as <span class="math inline"><em>Y</em><sub><em>i</em></sub> ← <em>Y</em><sub><em>i</em></sub> − <em>δ</em></span>.</p>
<p>We can define a proper function to do this, termed the <em>null specification</em> function, which takes two input arguments:</p>
<ul>
<li>
<code>y</code> which is a list storing the data points in the second sample;</li>
<li>
<code>parameters</code> which is a numeric vector of values for the parameters under investigation (here only <span class="math inline"><em>δ</em></span> and thus <code>parameters</code> is of length <span class="math inline">1</span> with <code>parameters[1] = delta</code>).</li>
</ul>
<p>In our simple example, it boils down to:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">null_spec</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span>, <span class="va">parameters</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">y</span>, <span class="op">~</span> <span class="va">.x</span> <span class="op">-</span> <span class="va">parameters</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="choose-suitable-test-statistics">Choose suitable test statistics<a class="anchor" aria-label="anchor" href="#choose-suitable-test-statistics"></a>
</h3>
<p>Next, we need to decide which test statistic(s) we are going to use for performing the test. Here, we are only interested in one parameter, namely the mean difference <span class="math inline"><em>δ</em></span>. Since the two samples share the same variance, we can use for example the <span class="math inline"><em>t</em></span>-statistic with a pooled estimate of the common variance.</p>
<p>This statistic can be easily computed using <code>stats::t.test(x, y, var.equal = TRUE)$statistic</code>. However, we want to extend its evaluation to any permuted version of the data. Test statistic functions compatible with <a href="https://lmjl-alea.github.io/flipr/" class="external-link"><strong>flipr</strong></a> should have at least two mandatory input arguments:</p>
<ul>
<li>
<code>data</code> which is either a concatenated list of size <span class="math inline"><em>n</em><sub><em>x</em></sub> + <em>n</em><sub><em>y</em></sub></span> regrouping the data points of both samples or a distance matrix of size <span class="math inline">(<em>n</em><sub><em>x</em></sub>+<em>n</em><sub><em>y</em></sub>) × (<em>n</em><sub><em>x</em></sub>+<em>n</em><sub><em>y</em></sub>)</span> stored as an object of class <code>dist</code>.</li>
<li>
<code>indices1</code> which is an integer vector of size <span class="math inline"><em>n</em><sub><em>x</em></sub></span> storing the indices of the data points belonging to the first sample in the current permuted version of the data.</li>
</ul>
<p>Some test statistics are already implemented in <a href="https://lmjl-alea.github.io/flipr/" class="external-link"><strong>flipr</strong></a> and ready to use. User-defined test statistics can be used as well, with the use of the helper function <code>use_stat(nsamples = 2, stat_name = )</code>. This function creates and saves an <code>.R</code> file in the <code>R/</code> folder of the current working directory and populates it with the following template:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Test Statistic for the Two-Sample Problem</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' This function computes the test statistic...</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param data A list storing the concatenation of the two samples from which</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#'   the user wants to make inference. Alternatively, a distance matrix stored</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#'   in an object of class \code{\link[stats]{dist}} of pairwise distances</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#'   between data points.</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param indices1 An integer vector that contains the indices of the data</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#'   points belong to the first sample in the current permuted version of the</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#'   data.</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">#' @return A numeric value evaluating the desired test statistic.</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">#' @export</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">#' @examples</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co">#' # TO BE DONE BY THE DEVELOPER OF THE PACKAGE</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>stat_{{{name}}} <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices1) {</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">inherits</span>(data, <span class="st">"dist"</span>))</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">attr</span>(data, <span class="st">"Size"</span>)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">inherits</span>(data, <span class="st">"list"</span>))</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">length</span>(data)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"The `data` input should be of class either list or dist."</span>)</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  indices2 <span class="ot">&lt;-</span> <span class="fu">seq_len</span>(n)[<span class="sc">-</span>indices1]</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> data[indices1]</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> data[indices2]</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Here comes the code that computes the desired test</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># statistic from input samples stored in lists x and y</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>For instance, a <a href="https://lmjl-alea.github.io/flipr/" class="external-link"><strong>flipr</strong></a>-compatible version of the <span class="math inline"><em>t</em></span>-statistic with pooled variance will look like:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_t_stat</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">indices1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"dist"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"Size"</span><span class="op">)</span></span>
<span>  <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"list"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  <span class="kw">else</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"The `data` input should be of class either list or dist."</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">indices2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="va">indices1</span><span class="op">]</span></span>
<span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="va">indices1</span><span class="op">]</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="va">indices2</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># Here comes the code that computes the desired test</span></span>
<span>  <span class="co"># statistic from input samples stored in lists x and y</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">statistic</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Here, we are only going to use the <span class="math inline"><em>t</em></span>-statistic for this example, but we might be willing to use more than one statistic for a parameter or we might have several parameters under investigation, each one of them requiring a different test statistic. We therefore group all the test statistics that we need into a single list:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stat_functions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">my_t_stat</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="assign-test-statistics-to-parameters">Assign test statistics to parameters<a class="anchor" aria-label="anchor" href="#assign-test-statistics-to-parameters"></a>
</h3>
<p>Finally we need to define a named list that tells <a href="https://lmjl-alea.github.io/flipr/" class="external-link"><strong>flipr</strong></a> which test statistics among the ones declared in the <code>stat_functions</code> list should be used for each parameter under investigation. This is used to determine bounds on each parameter for the plausibility function. This list, often termed <code>stat_assignments</code>, should therefore have as many elements as there are parameters under investigation. Each element should be named after a parameter under investigation and should list the indices corresponding to the test statistics that should be used for that parameter in <code>stat_functions</code>. In our example, it boils down to:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stat_assignments</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>delta <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="use-the-plausibility-function">Use the plausibility function<a class="anchor" aria-label="anchor" href="#use-the-plausibility-function"></a>
</h3>
<p>Now we can instantiate a plausibility function as follows:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pf</span> <span class="op">&lt;-</span> <span class="va"><a href="reference/PlausibilityFunction.html">PlausibilityFunction</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  null_spec <span class="op">=</span> <span class="va">null_spec</span>,</span>
<span>  stat_functions <span class="op">=</span> <span class="va">stat_functions</span>,</span>
<span>  stat_assignments <span class="op">=</span> <span class="va">stat_assignments</span>,</span>
<span>  <span class="va">x</span>, <span class="va">y</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; ! Setting the seed for sampling permutations is mandatory for obtaining a continuous p-value function. Using `seed = 1234`.</span></span></code></pre></div>
<p>Now, assume we want to test the following hypotheses:</p>
<p><span class="math display"><em>H</em><sub>0</sub> : <em>δ</em> = 0  v.s.  <em>H</em><sub>1</sub> : <em>δ</em> ≠ 0.</span></p>
<p>We use the <code>$get_value()</code> method for this purpose, which essentially evaluates the permutation <span class="math inline"><em>p</em></span>-value of a two-sided test by default:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pf</span><span class="op">$</span><span class="fu">get_value</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.1078921</span></span></code></pre></div>
<p>We can compare the resulting <span class="math inline"><em>p</em></span>-value with the one obtained using the more classic parametric test:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span><span class="co">#&gt; [1] 0.1030946</span></span></code></pre></div>
<p>The permutation <span class="math inline"><em>p</em></span>-value does not quite match the parametric one. This is because of two reasons:</p>
<ol style="list-style-type: decimal">
<li>The resolution of a permutation <span class="math inline"><em>p</em></span>-value is of the order of <span class="math inline">1/(<em>B</em>+1)</span>, where <span class="math inline"><em>B</em></span> is the number of sampled permutations. By default, the plausibility function is instantiated with <span class="math inline"><em>B</em> = 1000</span>:</li>
</ol>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pf</span><span class="op">$</span><span class="va">nperms</span></span>
<span><span class="co">#&gt; [1] 1000</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>We randomly sample <span class="math inline"><em>B</em></span> permutations out of the <span class="math inline">$\binom{n_x+n_y}{n_x}$</span> possible permutations and therefore introduce extra variability in the <span class="math inline"><em>p</em></span>-value.</li>
</ol>
<p>If we were to ask for more permutations, say <span class="math inline"><em>B</em> = 1, 000, 000</span>, we would be much closer to the parametric <span class="math inline"><em>p</em></span>-value:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pf</span><span class="op">$</span><span class="fu">set_nperms</span><span class="op">(</span><span class="fl">1000000</span><span class="op">)</span></span>
<span><span class="va">pf</span><span class="op">$</span><span class="fu">get_value</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.1029879</span></span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=flipr" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/LMJL-Alea/flipr/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/LMJL-Alea/flipr/issues/" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing flipr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Alessia Pini <br><small class="roles"> Author </small>  </li>
<li>Aymeric Stamm <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-8725-3654" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Simone Vantini <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/LMJL-Alea/flipr/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/LMJL-Alea/flipr/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://github.com/LMJL-Alea/flipr/actions" class="external-link"><img src="https://github.com/LMJL-Alea/flipr/workflows/test-coverage/badge.svg" alt="test-coverage"></a></li>
<li><a href="https://codecov.io/gh/LMJL-Alea/flipr?branch=master" class="external-link"><img src="https://codecov.io/gh/LMJL-Alea/flipr/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://github.com/LMJL-Alea/flipr/actions" class="external-link"><img src="https://github.com/LMJL-Alea/flipr/workflows/pkgdown/badge.svg" alt="pkgdown"></a></li>
<li><a href="https://CRAN.R-project.org/package=flipr" class="external-link"><img src="https://www.r-pkg.org/badges/version/flipr" alt="CRAN status"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Alessia Pini, Aymeric Stamm, Simone Vantini.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
