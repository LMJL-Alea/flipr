<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Two-Sample Permutation Test — two_sample_test • flipr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Two-Sample Permutation Test — two_sample_test"><meta property="og:description" content="This function carries out an hypothesis test in which the null hypothesis is
that the two samples are governed by the same underlying generative
probability distribution against the alternative hypothesis that they are
governed by two different generative probability distributions."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flipr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.3.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/flipr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/alternative.html">The alternative hypothesis in permutation testing</a>
    </li>
    <li>
      <a href="../articles/exactness.html">On the exactness of permutation tests</a>
    </li>
    <li>
      <a href="../articles/plausibility.html">Computing plausibility functions</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/LMJL-Alea/flipr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Two-Sample Permutation Test</h1>
    <small class="dont-index">Source: <a href="https://github.com/LMJL-Alea/flipr/blob/HEAD/R/two-sample-test.R" class="external-link"><code>R/two-sample-test.R</code></a></small>
    <div class="hidden name"><code>two_sample_test.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function carries out an hypothesis test in which the null hypothesis is
that the two samples are governed by the same underlying generative
probability distribution against the alternative hypothesis that they are
governed by two different generative probability distributions.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">two_sample_test</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">stat_t</span><span class="op">)</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>  M <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two_tail"</span>,</span>
<span>  combine_with <span class="op">=</span> <span class="st">"tippett"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"exact"</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A numeric vector or a numeric matrix or a list representing the 1st
sample. Alternatively, it can be a distance matrix stored as an object of
class <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code>, in which case test statistics based on
inter-point distances (marked with the <code>_ip</code> suffix) should be used.</p></dd>


<dt>y</dt>
<dd><p>A numeric vector if <code>x</code> is a numeric vector, or a numeric matrix if
<code>x</code> is a numeric matrix, or a list if <code>x</code> is a list, representing the second
sample. Alternatively, if <code>x</code> is an object of class
<code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code>, it should be a numeric scalar specifying the
size of the first sample.</p></dd>


<dt>stats</dt>
<dd><p>A list of functions produced by <code><a href="https://rlang.r-lib.org/reference/as_function.html" class="external-link">as_function</a></code>
specifying the chosen test statistic(s). A number of test statistic
functions are implemented in the package and can be used as such.
Alternatively, one can provide its own implementation of test statistics
that (s)he deems relevant for the problem at hand. See the section
<em>User-supplied statistic function</em> for more information on how these
user-supplied functions should be structured for compatibility with the
<strong>flipr</strong> framework. Default is <code>list(<a href="two-sample-stats.html">stat_t</a>)</code>.</p></dd>


<dt>B</dt>
<dd><p>The number of sampled permutations. Default is <code>1000L</code>.</p></dd>


<dt>M</dt>
<dd><p>The total number of possible permutations. Defaults to <code>NULL</code>, which
means that it is automatically computed from the given sample size(s).</p></dd>


<dt>alternative</dt>
<dd><p>A single string or a character vector specifying whether
the p-value is right-tailed, left-tailed or two-tailed. Choices are
<code>"right_tail"</code>, <code>"left_tail"</code> and <code>"two_tail"</code>. Default is <code>"two_tail"</code>. If
a single string is provided, it is assumed that it should be applied to all
test statistics provided by the user. Alternative, the length of
<code>alternative</code> should match the length of the <code>stats</code> parameter and it is
assumed that there is a one-to-one correspondence.</p></dd>


<dt>combine_with</dt>
<dd><p>A string specifying the combining function to be used to
compute the single test statistic value from the set of p-value estimates
obtained during the non-parametric combination testing procedure. For now,
choices are either <code>"tippett"</code> or <code>"fisher"</code>. Default is <code>"tippett"</code>, which
picks Tippett's function.</p></dd>


<dt>type</dt>
<dd><p>A string specifying which formula should be used to compute the
p-value. Choices are <code>exact</code> (default), <code>upper_bound</code> and <code>estimate</code>. See
Phipson &amp; Smith (2010) for details.</p></dd>


<dt>seed</dt>
<dd><p>An integer specifying the seed of the random generator useful for
result reproducibility or method comparisons. Default is <code>NULL</code>.</p></dd>


<dt>...</dt>
<dd><p>Extra parameters specific to some statistics.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></code> with three components: the value of the
statistic for the original two samples, the p-value of the resulting
permutation test and a numeric vector storing the values of the permuted
statistics.</p>
    </div>
    <div id="user-supplied-statistic-function">
    <h2>User-supplied statistic function</h2>
    

<p>A user-specified function should have at least two arguments:</p><ul><li><p>the first argument is <code>data</code> which should be a list of the <code>n1 + n2</code>
concatenated observations with the original <code>n1</code> observations from the first
sample on top and the original <code>n2</code> observations from the second sample
below;</p></li>
<li><p>the second argument is <code>perm_data</code> which should be an integer vector giving
the indices in <code>data</code> that are considered to belong to the first sample.</p></li>
</ul><p>It is possible to use the <code><a href="use_stat.html">use_stat</a></code> function with <code>nsamples = 2</code>
to have <strong>flipr</strong> automatically generate a template file for writing down
your own test statistics in a way that makes it compatible with the <strong>flipr</strong>
framework.</p>
<p>See the <code><a href="two-sample-stats.html">stat_t</a></code> function for an example.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10L</span></span></span>
<span class="r-in"><span><span class="va">mx</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Two different models for the two populations</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, mean <span class="op">=</span> <span class="va">mx</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">my</span> <span class="op">&lt;-</span> <span class="va">mx</span> <span class="op">+</span> <span class="va">delta</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, mean <span class="op">=</span> <span class="va">my</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu">two_sample_test</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">t1</span><span class="op">$</span><span class="va">pvalue</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Same model for the two populations</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, mean <span class="op">=</span> <span class="va">mx</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="va">my</span> <span class="op">&lt;-</span> <span class="va">mx</span> <span class="op">+</span> <span class="va">delta</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, mean <span class="op">=</span> <span class="va">my</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">t2</span> <span class="op">&lt;-</span> <span class="fu">two_sample_test</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">t2</span><span class="op">$</span><span class="va">pvalue</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8131841</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Alessia Pini, Aymeric Stamm, Simone Vantini.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

